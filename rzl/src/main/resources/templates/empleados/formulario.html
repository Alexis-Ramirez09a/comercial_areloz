<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">

<head>
  <meta charset="UTF-8" />
  <title>Formulario Empleado</title>
  <link th:href="@{/webjars/bootstrap-icons/1.10.5/font/bootstrap-icons.css}" rel="stylesheet" />
  <link th:href="@{/webjars/bootstrap/5.3.2/css/bootstrap.min.css}" rel="stylesheet" />
  <style>
    body {
      background: linear-gradient(to right, #e3f2fd, #ede7f6);
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #333;
    }

    .container {
      background: #ffffff;
      padding: 2.5rem;
      border-radius: 16px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
      max-width: 700px;
      width: 100%;
    }

    h2 {
      text-align: center;
      margin-bottom: 1.5rem;
      color: #4a148c;
      font-weight: 700;
    }

    label {
      font-weight: 500;
    }

    .btn-custom {
      background-color: #5c6bc0;
      color: #fff;
      border: none;
    }

    .btn-custom:hover {
      background-color: #3f51b5;
    }

    .btn-secondary {
      background-color: #d1c4e9;
      border: none;
      color: #4a148c;
    }

    .btn-secondary:hover {
      background-color: #b39ddb;
    }
  </style>
</head>

<body>
  <div class="container">
    <h2 th:text="${empleado.id == null} ? 'Nuevo Empleado' : 'Editar Empleado'"></h2>

    <form th:action="@{/empleados/guardar}" th:object="${empleado}" method="post">
      <!-- ID oculto -->
      <input type="hidden" th:field="*{id}" />
      <!-- Fecha oculta -->
      <input type="hidden" th:field="*{fechaRegistro}" />

      <!-- Nombre -->
      <div class="mb-3">
        <label for="nombre" class="form-label">Nombre</label>
        <input type="text" th:field="*{nombre}" class="form-control" required pattern="[A-Za-zÁÉÍÓÚÑáéíóúñ\s]+"
          title="Solo letras" oninput="this.value = this.value.replace(/[^A-Za-zÁÉÍÓÚÑáéíóúñ\s]/g, '')" />
        <div class="text-danger" th:if="${#fields.hasErrors('nombre')}" th:errors="*{nombre}"></div>
      </div>

      <!-- Apellido -->
      <div class="mb-3">
        <label for="apellido" class="form-label">Apellido</label>
        <input type="text" th:field="*{apellido}" class="form-control" required pattern="[A-Za-zÁÉÍÓÚÑáéíóúñ\s]+"
          title="Solo letras" oninput="this.value = this.value.replace(/[^A-Za-zÁÉÍÓÚÑáéíóúñ\s]/g, '')" />
        <div class="text-danger" th:if="${#fields.hasErrors('apellido')}" th:errors="*{apellido}"></div>
      </div>

      <!-- Cédula -->
      <div class="mb-3">
        <label for="cedula" class="form-label">Cédula</label>
        <input type="text" th:field="*{cedula}" class="form-control" maxlength="10" required pattern="[0-9]{10}"
          title="Solo números (10 dígitos)" oninput="this.value = this.value.replace(/[^0-9]/g, '')" />
        <div class="text-danger" th:if="${#fields.hasErrors('cedula')}" th:errors="*{cedula}"></div>
      </div>

      <!-- Correo -->
      <div class="mb-3">
        <label for="correo" class="form-label">Correo</label>
        <input type="email" th:field="*{correo}" class="form-control" />
        <div class="text-danger" th:if="${#fields.hasErrors('correo')}" th:errors="*{correo}"></div>
      </div>

      <!-- Teléfono -->
      <div class="mb-3">
        <label for="telefono" class="form-label">Teléfono</label>
        <input type="text" th:field="*{telefono}" class="form-control" maxlength="10" pattern="[0-9]{10}"
          title="Solo números (10 dígitos)" oninput="this.value = this.value.replace(/[^0-9]/g, '')" />
        <div class="text-danger" th:if="${#fields.hasErrors('telefono')}" th:errors="*{telefono}"></div>
      </div>

      <!-- Botones -->
      <div class="d-flex justify-content-between">
        <a th:href="@{/}" class="btn btn-secondary">← Cancelar</a>
        <button type="submit" class="btn btn-custom">Guardar</button>
      </div>
    </form>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const soloNumeros = (event) => {
        const tecla = event.key;
        if (!/^\d$/.test(tecla)) {
          event.preventDefault();
        }
      };

      const bloquearPegado = (event) => {
        const texto = event.clipboardData.getData("text");
        if (!/^\d{1,10}$/.test(texto)) {
          event.preventDefault();
          alert("Solo se permiten números y máximo 10 dígitos.");
        }
      };

      const cedula = document.querySelector("input[name='cedula']");
      const telefono = document.querySelector("input[name='telefono']");

      [cedula, telefono].forEach((input) => {
        if (input) {
          input.addEventListener("keypress", soloNumeros);
          input.addEventListener("paste", bloquearPegado);
        }
      });
    });
  </script>
</body>

</html>